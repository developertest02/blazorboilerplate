@inherits ExercisesPagingBasePage
@page "/exercises-paging"

<TopSection>
    <Breadcrumbs>
        <Breadcrumb Title="Exercises List" />
    </Breadcrumbs>
</TopSection>

<PageTitle>Exercises List - Server Side Filtering, Sorting and Pagination example</PageTitle>

<DateTimeFilter Busy="isBusy" Filter="exerciseFilter" />

<MudGrid Spacing="0" Class="my-4">
    <MudItem xs="6" sm="3" Class="px-8">
        <MudSelect Disabled="@isBusy" @bind-Value="@exerciseFilter.CreatedById" FullWidth="true" Label="Creators">
            @foreach (var user in Creators)
            {
                <MudSelectItem Value="@user.Id">@user.DisplayValue</MudSelectItem>
            }
        </MudSelect>
    </MudItem>
    <MudItem xs="6" sm="3" Class="px-8">
        <MudSelect Disabled="@isBusy" @bind-Value="@exerciseFilter.ModifiedById" FullWidth="true" Label="Editors">
            @foreach (var user in Editors)
            {
                <MudSelectItem Value="@user.Id">@user.DisplayValue</MudSelectItem>
            }
        </MudSelect>
    </MudItem>
    <MudItem xs="6" sm="3" Class="px-8">
         <MudTextField T="string" ValueChanged="@(s=>OnSearch(s))" Placeholder=@L["Search"] Adornment="Adornment.End" AdornmentIcon="@Icons.Filled.Search" AdornmentColor="Color.Secondary" />
    </MudItem>
    <MudItem xs="6" sm="3" Class="px-8">

    </MudItem>
</MudGrid>

<MudGrid Spacing="0" Class="my-4">
    <MudItem xs="10" sm="4" Class="d-flex align-center justify-center mud-width-full px-8">
        <MudTextField T="string" ValueChanged="@(s=>OnSearch(s))" Placeholder=@L["Search"] Adornment="Adornment.End" AdornmentIcon="@Icons.Filled.Search" AdornmentColor="Color.Secondary" />
    </MudItem>
</MudGrid>

<div class="d-flex flex-wrap mb-4 mx-4">
    <MudFab Icon="@Icons.Filled.Refresh" OnClick="@(() => Reload())" Size="Size.Medium" Class="ma-2" />
</div>

<MudTable ServerData="@(new Func<TableState, Task<TableData<Exercise>>>(ServerReload))" Striped="true" Bordered="true" Dense="true" Hover="true" Class="rounded-0 pa-2" Elevation="0"
          Loading="@isBusy" LoadingProgressColor="Color.Info" @ref="table">
    <HeaderContent>

        <MudTh><MudTableSortLabel SortLabel="Name" T="Exercise">@L["Named"]</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortLabel="CreatedOn" T="Exercise">@L["CreatedOn"]</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortLabel="CreatedBy.UserName" T="Exercise">@L["CreatedBy"]</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortLabel="ModifiedBy.UserName" T="Exercise">@L["ModifiedBy"]</MudTableSortLabel></MudTh>
    </HeaderContent>
    <RowTemplate Context="row">
        <MudTd DataLabel="@L["Name"]">@row.Name</MudTd>
        <MudTd DataLabel="@L["CreatedOn"]">@row.CreatedOn</MudTd>
        <MudTd DataLabel="@L["CreatedBy"]">@row.CreatedBy?.UserName</MudTd>
        <MudTd DataLabel="@L["ModifiedBy"]">@row.ModifiedBy?.UserName</MudTd>
    </RowTemplate>
    <PagerContent>
        <MudTablePager RowsPerPageString=@L["Rows per page"] />
    </PagerContent>
</MudTable>

@code {

}
